# Final Project
#Kevin Hansen, Peter Henry, Noel Ford

```{r}
# Reading in the CSV file as a data frame
library(tidyverse)
library(readr)
df <- read_csv("C:\\Users\\kchan\\OneDrive\\Desktop\\Police_Department_Incident_Reports__2018_to_Present_20240208.csv")
glimpse(df)
```

```{r}
#Creating a subset of the original data frame with only relevant data
incidentFrame <- df[c("Incident Date", "Incident Time", "Incident Year", "Incident Day of Week",
                       "Incident ID", "Incident Number", "Report Type Code", "Report Type Description", "Incident Code",
                       "Incident Category", "Incident Subcategory", "Incident Description", "Police District")]
glimpse(incidentFrame)

```

```{r}
table(incidentFrame$`Incident Category`)
#plotCategories <- ggplot(incidentFrame) + geom_col(aes(x = "Incident Category"), y = count("Incident Category"))
#plotCategories
```

```{r}
library(arules)
library(tidyverse)
library(readr)
library(lubridate)
library(data.table)

#Police DataBase
policedf <- read_csv("C:/Users/Noal/Downloads/Police_Department_Incident_Reports__2018_to_Present_20240208.csv")
policedf
str(policedf)

#Research Question: What time of day and what day of the week are the most incedent reports reported 
                    #so the police department can know when to have more or less officers on duty? 


#Create database with only days and times
timeDF <- policedf[ , 2:5] 

timeDF

# What day or days do incidents happen the most
days <- timeDF %>% count(`Incident Day of Week`, sort = TRUE)

#Graph days
daysPlot <- ggplot(data=days, aes(x=days$`Incident Day of Week`, y=days$n)) +
  geom_bar(stat="identity")

daysPlot

#What hour or hours do the incidents happen the most

timeDF$hour <- hour(timeDF$`Incident Time`)

hours <- timeDF %>% count(hour, sort = TRUE)


#Graph hours

hourPlot <- ggplot(data=hours, aes(x=hours$hour, y=hours$n)) +
  geom_bar(stat="identity")

hourPlot

#What hours on which days (e.g what hours on Monday do most incidents occur?)

hoursDays <- timeDF[, 4:5]

#Monday Hours / Plot

Monday <- hoursDays[hoursDays$`Incident Day of Week` == "Monday" ,]

MondayHours <- Monday %>% count(hour, sort=TRUE)

MondayHours

MondayPlot <- ggplot(data=MondayHours, aes(x=hour, y=n)) +
  geom_bar(stat="identity", color="red", fill="red") + 
  ggtitle ("Monday Hours")

MondayPlot

#Tuesday Hours / Plot

Tuesday <- hoursDays[hoursDays$`Incident Day of Week` == "Tuesday" ,]

TuesdayHours <- Tuesday %>% count(hour, sort=TRUE)

TuesdayHours

TuesdayPlot <- ggplot(data=TuesdayHours, aes(x=hour, y=n)) +
  geom_bar(stat="identity", color="red", fill="red") + 
  ggtitle ("Tuesday Hours")

TuesdayPlot

#Wednesday Hours / Plot

Wednesday <- hoursDays[hoursDays$`Incident Day of Week` == "Wednesday" ,]

WednesdayHours <- Wednesday %>% count(hour, sort=TRUE)

WednesdayHours

WednesdayPlot <- ggplot(data=WednesdayHours, aes(x=hour, y=n)) +
  geom_bar(stat="identity", color="black", fill="green") + 
  ggtitle ("Wednesday Hours")

WednesdayPlot

#Thursday hours / Plot

Thursday <- hoursDays[hoursDays$`Incident Day of Week` == "Thursday" ,]

ThursdayHours <- Thursday %>% count(hour, sort=TRUE)

ThursdayHours

ThursdayPlot <- ggplot(data=ThursdayHours, aes(x=hour, y=n)) +
  geom_bar(stat="identity", color="black", fill="yellow") + 
  ggtitle ("Thursday Hours")

ThursdayPlot

#Friday hours / Plot

Friday <- hoursDays[hoursDays$`Incident Day of Week` == "Friday" ,]

FridayHours <- Friday %>% count(hour, sort=TRUE)

FridayHours

FridayPlot <- ggplot(data=FridayHours, aes(x=hour, y=n)) +
  geom_bar(stat="identity", color="red", fill="red") + 
  ggtitle ("Friday Hours")

FridayPlot

#Saturday Hours / Plot

Saturday <- hoursDays[hoursDays$`Incident Day of Week` == "Saturday" ,]

SaturdayHours <- Saturday %>% count(hour, sort=TRUE)

SaturdayHours

SaturdayPlot <- ggplot(data=SaturdayHours, aes(x=hour, y=n)) +
  geom_bar(stat="identity", color="black", fill="green") + 
  ggtitle ("Saturday Hours")

SaturdayPlot

#Sunday Hours / Plot

Sunday <- hoursDays[hoursDays$`Incident Day of Week` == "Sunday" ,]

SundayHours <- Sunday %>% count(hour, sort=TRUE)

SundayHours

SundayPlot <- ggplot(data=SundayHours, aes(x=hour, y=n)) +
  geom_bar(stat="identity", color="black", fill="green") + 
  ggtitle ("Sunday Hours")

SundayPlot



```{r}

```
